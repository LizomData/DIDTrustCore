package model

type Blobs struct {
	ID    int    `gorm:"column:id;primaryKey;autoIncrement"`
	Value string `gorm:"column:value;type:text;not null"`
}

type BlobsCustomer struct {
	UserID    uint   `gorm:"column:user_id;"`
	Value     string `gorm:"column:value;type:text;not null"`
	CreatedAt int64  `gorm:"type:bigint;index:idx_created;comment:创建时间" json:"created_at"`
	UpdatedAt int64  `gorm:"type:bigint;index:idx_updated;comment:更新时间" json:"updated_at"`
}

type VulnerabilityData struct {
	ID          string      `json:"id" binding:"required"` // 必填字段
	Assigner    []string    `json:"assigner" binding:"required"`
	Description string      `json:"description" binding:"required"`
	Refs        []Reference `json:"-"` // 忽略的字段
	Severities  []Severity  `json:"severities" binding:"required"`
}

// Refs字段的嵌套结构体
type Reference struct {
	URL string `json:"url"`
}

// Severities字段的嵌套结构体
type Severity struct {
	Scheme string        `json:"scheme"`
	Value  SeverityValue `json:"value"` // 嵌套对象
	Source string        `json:"source"`
	Rank   int           `json:"rank"`
}

// Severity.Value字段的嵌套结构体
type SeverityValue struct {
	Vector  string `json:"vector"`
	Version string `json:"version"`
}
